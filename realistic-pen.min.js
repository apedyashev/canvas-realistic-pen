function RealisticPen(a,b){function c(a,b){function c(){var a;for(k.lineWidth=s.brushSize,k.strokeStyle="rgba("+s.penColor[0]+", "+s.penColor[1]+", "+s.penColor[2]+",  "+s.brushPressure+")",a=0;a<n.length;a++)k.beginPath(),k.moveTo(n[a].dx,n[a].dy),n[a].dx-=n[a].ax=(n[a].ax+(n[a].dx-l)*n[a].div)*n[a].ease,n[a].dy-=n[a].ay=(n[a].ay+(n[a].dy-m)*n[a].div)*n[a].ease,k.lineTo(n[a].dx,n[a].dy),k.stroke()}var d=a.parentNode;b&&(s=h(s,b)),s.penColor=i(s.penColor),a.width=d.offsetWidth?d.offsetWidth:q,a.height=d.offsetHeight?d.offsetHeight:r,p=a,k=p.getContext("2d"),g(),k.globalCompositeOperation="source-over",l=p.width/2,m=p.height/2,n=[];for(var e=0;e<s.brushesCount;e++)n.push({dx:p.width/2,dy:p.height/2,ax:0,ay:0,div:.1,ease:.5+.005*e});o=setInterval(c,1e3/60)}function d(a,b){l=a,m=b;for(var c=0;c<n.length;c++)n[c].dx=a,n[c].dy=b}function e(a,b){l=a,m=b}function f(){}function g(){var a=function(a){d(a.pageX-p.offsetLeft,a.pageY-p.offsetTop),p.addEventListener("mousemove",b,!1),p.addEventListener("mouseup",c,!1)},b=function(a){e(a.pageX-p.offsetLeft,a.pageY-p.offsetTop)},c=function(){f(),p.removeEventListener("mousemove",b,!1),p.removeEventListener("mouseup",c,!1)},g=function(a){1==a.touches.length&&(a.preventDefault(),d(a.touches[0].pageX,a.touches[0].pageY),p.addEventListener("touchmove",h,!1),p.addEventListener("touchend",i,!1))},h=function(a){1==a.touches.length&&(a.preventDefault(),e(a.touches[0].pageX,a.touches[0].pageY))},i=function(a){0===a.touches.length&&(a.preventDefault(),f(),p.removeEventListener("touchmove",h,!1),p.removeEventListener("touchend",i,!1))};p.addEventListener("mousedown",a,!1),p.addEventListener("touchstart",g,!1)}function h(a,b){var c,d;a||(a={}),b||(b={});for(c in b)d=b[c],a[c]=d;return a}function i(a){var b=[0,0,0];return/^#./.test(a)?b=j(a):/^rgb\(./.test(a)?b=a.substring(4,a.length-1).replace(/ /g,"").split(","):/^rgba\(./.test(a)?(b=a.substring(5,a.length-1).replace(/ /g,"").split(","),b.pop()):"[object Array]"===Object.prototype.toString.call(a)&&(b=a),b}function j(a){var b=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;a=a.replace(b,function(a,b,c,d){return b+b+c+c+d+d});var c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return c?[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]:[0,0,0]}var k=null,l=null,m=null,n=null,o=null,p=null,q=200,r=200,s={penColor:[0,0,0],brushPressure:1,brushSize:3,brushesCount:4};this.destroy=function(){clearInterval(o)},this.setPenColor=function(a){s.penColor=i(a)},this.setBrushPressure=function(a){s.brushPressure=a},this.setBrushSize=function(a){s.brushSize=a},this.setBrushesCount=function(a){s.brushesCount=a},c(a,b)}