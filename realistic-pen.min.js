function RealisticPen(a,b){function c(a,b){function c(){var a;for(l.lineWidth=u.brushSize,l.strokeStyle="rgba("+u.penColor[0]+", "+u.penColor[1]+", "+u.penColor[2]+",  "+u.brushPressure+")",a=0;a<o.length;a++)l.beginPath(),l.moveTo(o[a].dx,o[a].dy),o[a].dx-=o[a].ax=(o[a].ax+(o[a].dx-m)*o[a].div)*o[a].ease,o[a].dy-=o[a].ay=(o[a].ay+(o[a].dy-n)*o[a].div)*o[a].ease,l.lineTo(o[a].dx,o[a].dy),l.stroke()}r=a.parentNode,b&&(u=h(u,b)),u.penColor=i(u.penColor),q=a,l=q.getContext("2d"),g(),l.globalCompositeOperation="source-over",m=q.width/2,n=q.height/2,o=[];for(var d=0;d<u.brushesCount;d++)o.push({dx:q.width/2,dy:q.height/2,ax:0,ay:0,div:.1,ease:.5+.005*d});p=setInterval(c,1e3/60)}function d(a,b){m=a,n=b;for(var c=0;c<o.length;c++)o[c].dx=a,o[c].dy=b}function e(a,b){m=a,n=b}function f(){}function g(){var a=function(a){var e=k(q);d(a.pageX-e.left,a.pageY-e.top),q.addEventListener("mousemove",b,!1),q.addEventListener("mouseup",c,!1)},b=function(a){var b=k(q);e(a.pageX-b.left,a.pageY-b.top)},c=function(){f(),q.removeEventListener("mousemove",b,!1),q.removeEventListener("mouseup",c,!1)},g=function(a){if(1==a.touches.length){a.preventDefault();var b=k(q);d(a.touches[0].pageX-b.left,a.touches[0].pageY-b.top),q.addEventListener("touchmove",h,!1),q.addEventListener("touchend",i,!1)}},h=function(a){if(1==a.touches.length){a.preventDefault();var b=k(q);e(a.touches[0].pageX-b.left,a.touches[0].pageY-b.top)}},i=function(a){0===a.touches.length&&(a.preventDefault(),f(),q.removeEventListener("touchmove",h,!1),q.removeEventListener("touchend",i,!1))},j=function(){q.width=r.offsetWidth?r.offsetWidth:s,q.height=r.offsetHeight?r.offsetHeight:t};q.addEventListener("mousedown",a,!1),q.addEventListener("touchstart",g,!1),window.addEventListener("resize",j,!1),j()}function h(a,b){var c,d;a||(a={}),b||(b={});for(c in b)d=b[c],a[c]=d;return a}function i(a){var b=[0,0,0];return/^#./.test(a)?b=j(a):/^rgb\(./.test(a)?b=a.substring(4,a.length-1).replace(/ /g,"").split(","):/^rgba\(./.test(a)?(b=a.substring(5,a.length-1).replace(/ /g,"").split(","),b.pop()):"[object Array]"===Object.prototype.toString.call(a)&&(b=a),b}function j(a){var b=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;a=a.replace(b,function(a,b,c,d){return b+b+c+c+d+d});var c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return c?[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]:[0,0,0]}function k(a){var b,c,d={top:0,left:0},e=a&&a.ownerDocument,f=function(a){return null!==a&&a===a.window},g=function(a){return f(a)?a:9===a.nodeType&&a.defaultView};if(e)return b=e.documentElement,"undefined"!=typeof a.getBoundingClientRect&&(d=a.getBoundingClientRect()),c=g(e),{top:d.top+c.pageYOffset-b.clientTop,left:d.left+c.pageXOffset-b.clientLeft}}var l=null,m=null,n=null,o=null,p=null,q=null,r=null,s=200,t=200,u={penColor:[0,0,0],brushPressure:1,brushSize:3,brushesCount:4};this.destroy=function(){clearInterval(p)},this.setPenColor=function(a){u.penColor=i(a)},this.setBrushPressure=function(a){u.brushPressure=a},this.setBrushSize=function(a){u.brushSize=a},this.setBrushesCount=function(a){u.brushesCount=a},c(a,b)}