function RealisticPen(a,b){function c(a,b){function c(a){var b=a?a:1;return"rgba("+y.penColor[0]+", "+y.penColor[1]+", "+y.penColor[2]+",  "+b+")"}function d(){var a,b=z[r]+y.brushSize/f;for(a=0;a<s.length;a++){l.beginPath();var d=s[a].dx,e=s[a].dy;s[a].ax=(s[a].ax+(s[a].dx-m)*s[a].div)*s[a].ease,s[a].dx-=s[a].ax,s[a].ay=(s[a].ay+(s[a].dy-n)*s[a].div)*s[a].ease,s[a].dy-=s[a].ay,l.strokeStyle=c(.35),l.lineWidth=b+2,l.lineCap="butt",l.lineJoin="miter",l.moveTo(d,e),l.lineTo(s[a].dx,s[a].dy),l.stroke(),l.strokeStyle=c(1),l.lineWidth=b,l.lineCap="round",l.lineJoin="round",l.moveTo(d,e),l.lineTo(s[a].dx,s[a].dy),l.stroke()}}v=a.parentNode,b&&(y=h(y,b)),y.penColor=i(y.penColor),u=a,l=u.getContext("2d"),g(),l.globalCompositeOperation="source-over",m=u.width/2,n=u.height/2,s=[];for(var e=0;1>e;e++)s.push({dx:u.width/2,dy:u.height/2,ax:0,ay:0,div:.08,ease:.7});t=setInterval(d,1e3/90);var f=0;for(var j in z)f=Math.max(f,z[j])}function d(a,b){o=m=a,p=n=b;for(var c=0;c<s.length;c++)s[c].dx=a,s[c].dy=b}function e(a,b){q.x=m,q.y=n,m=a,n=b;var c=Math.abs(q.x-m);r=null!==r&&2<=Math.abs(r-c)?c>r?r+1:r-1:c}function f(a,b){if(o===a&&p===b){var c,d=y.brushSize/2;for(c=0;c<s.length;c++)l.beginPath(),l.arc(a,b,d,0,2*Math.PI,!1),l.fillStyle=l.strokeStyle,l.fill(),l.lineWidth=1,l.strokeStyle=l.strokeStyle,l.stroke()}}function g(){var a=function(a){var e=k(u);d(a.pageX-e.left,a.pageY-e.top),u.addEventListener("mousemove",b,!1),u.addEventListener("mouseup",c,!1)},b=function(a){var b=k(u);e(a.pageX-b.left,a.pageY-b.top)},c=function(a){var d=k(u);f(a.pageX-d.left,a.pageY-d.top),u.removeEventListener("mousemove",b,!1),u.removeEventListener("mouseup",c,!1)},g=function(a){if(1==a.touches.length){a.preventDefault();var b=k(u);d(a.touches[0].pageX-b.left,a.touches[0].pageY-b.top),u.addEventListener("touchmove",h,!1),u.addEventListener("touchend",i,!1)}},h=function(a){if(1==a.touches.length){a.preventDefault();var b=k(u);e(a.touches[0].pageX-b.left,a.touches[0].pageY-b.top)}},i=function(a){0===a.touches.length&&(a.preventDefault(),f(),u.removeEventListener("touchmove",h,!1),u.removeEventListener("touchend",i,!1))},j=function(){u.width=v.offsetWidth?v.offsetWidth:w,u.height=v.offsetHeight?v.offsetHeight:x};u.addEventListener("mousedown",a,!1),u.addEventListener("touchstart",g,!1),window.addEventListener("resize",j,!1),j()}function h(a,b){var c,d;a||(a={}),b||(b={});for(c in b)d=b[c],a[c]=d;return a}function i(a){var b=[0,0,0];return/^#./.test(a)?b=j(a):/^rgb\(./.test(a)?b=a.substring(4,a.length-1).replace(/ /g,"").split(","):/^rgba\(./.test(a)?(b=a.substring(5,a.length-1).replace(/ /g,"").split(","),b.pop()):"[object Array]"===Object.prototype.toString.call(a)&&(b=a),b}function j(a){var b=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;a=a.replace(b,function(a,b,c,d){return b+b+c+c+d+d});var c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return c?[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]:[0,0,0]}function k(a){var b,c,d={top:0,left:0},e=a&&a.ownerDocument,f=function(a){return null!==a&&a===a.window},g=function(a){return f(a)?a:9===a.nodeType&&a.defaultView};if(e)return b=e.documentElement,"undefined"!=typeof a.getBoundingClientRect&&(d=a.getBoundingClientRect()),c=g(e),{top:d.top+c.pageYOffset-b.clientTop,left:d.left+c.pageXOffset-b.clientLeft}}var l=null,m=null,n=null,o=null,p=null,q={x:null,y:null},r=null,s=null,t=null,u=null,v=null,w=200,x=200,y={penColor:[0,0,0],brushSize:3},z={1:4.5,2:4.25,3:4,4:3.75,5:3.5,6:3.25,7:3,8:2.75,9:2.5,10:2.25,11:2.2,12:2.15,13:2.1,14:2.05,15:2,16:1.95,17:1.9,18:1.85,19:1.8,20:1.75,21:1.7,22:1.65,23:1.6,24:1.55,25:1.5,26:1.48,27:1.46,28:1.44,29:1.42,30:1.4,31:1.38,32:1.36,33:1.34,34:1.32,35:1.3,36:1.28,37:1.26,38:1.24,39:1.22,40:1.2,41:1.18,42:1.16,43:1.14,44:1.12,45:1.1,46:1.08,47:1.06,48:1.04,49:1.02,50:1};this.destroy=function(){clearInterval(t)},this.setPenColor=function(a){y.penColor=i(a)},this.setBrushSize=function(a){y.brushSize=a},c(a,b)}